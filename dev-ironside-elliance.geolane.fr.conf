server {
    listen       80;
    listen  [::]:80;
    server_name  dev-ironside-elliance.geolane.fr;
    return 301 https://dev-ironside-elliance.geolane.fr;  
 }

server {
    listen       443 ssl;
    listen  [::]:443;
    server_name  dev-ironside-elliance.geolane.fr;
    client_max_body_size 100M;

    #TLS
    ssl_certificate     /etc/letsencrypt/live/dev-ironside-elliance.geolane.fr/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/dev-ironside-elliance.geolane.fr/privkey.pem;
    ssl_protocols       TLSv1.2 TLSv1.3;
    ssl_ciphers         ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;

    location / {
      root   /usr/share/nginx/html;
      try_files $uri $uri/ /index.html;
      index  index.html index.htm;
      error_page 405 = $uri;
      proxy_set_header HOST $host;
      proxy_set_header X-Real-IP $remote_addr;

      add_header 'Access-Control-Allow-Origin' '*';
      add_header 'Access-Control-Allow-Credentials' 'true';
      proxy_set_header Host      $host:$server_port;
      proxy_set_header X-Real-IP $remote_addr;

}
 
    location /produit {

       proxy_pass http://elliance-gateway:8081/produit;
    }

    location /contrat {
     proxy_set_header Host      $host:$server_port;
     proxy_set_header X-Real-IP $remote_addr;
     proxy_pass http://elliance-gateway:8081/contrat;
    }

    location /user {

	proxy_pass http://elliance-backend:8083/user;
        proxy_set_header Host      $host:$server_port;
	proxy_set_header X-Real-IP $remote_addr;
     }
     location /role {

        proxy_pass http://elliance-gateway:8081/role;
        proxy_set_header Host      $host:$server_port;
        proxy_set_header X-Real-IP $remote_addr;
     }

    location /personnemorale {
       
       proxy_pass http://elliance-gateway:8081/personnemorale;
    }
	location /droit {
		proxy_pass http://elliance-gateway:8081/droit;
        proxy_set_header Host      $host:$server_port;
		proxy_set_header X-Real-IP $remote_addr;
    }
	
	location /cxml {
		proxy_pass http://elliance-gateway:8081/cxml;
        proxy_set_header Host      $host:$server_port;
		proxy_set_header X-Real-IP $remote_addr;
    }
	 
    location /personnephysique {
       
       proxy_pass http://elliance-backend:8083/personnephysique;
    }
    location /reportage-image {
       proxy_pass http://elliance-backend:8083/reportage-image;
    }
    location /photo {
       proxy_pass http://elliance-backend:8083/photo;
    }
    location /pp-image {
       proxy_pass http://elliance-backend:8083/reportage-image;
    }


    location /image {
       
       proxy_set_header Host      $host:$server_port;
       proxy_set_header X-Real-IP $remote_addr;
 
      proxy_pass http://elliance-backend:8083/image;
    }
    location /entite {
	
      proxy_set_header HOST $host;
      proxy_set_header X-Real-IP $remote_addr;

      add_header 'Access-Control-Allow-Origin' '*';
      add_header 'Access-Control-Allow-Credentials' 'true';
      #proxy_set_header Host      $host:$server_port;
      proxy_set_header X-Real-IP $remote_addr;
       


       proxy_pass http://elliance-backend:8083/entite;
    }

    location /email {
       
       proxy_pass http://elliance-backend:8083/email;
    }
    location /tel {
       
       proxy_pass http://elliance-backend:8083/tel;
    }
    location /fax {
       proxy_pass http://elliance-backend:8083/fax;
    }
    location /commentaire {
       proxy_pass http://elliance-backend:8083/commentaire;
    }
    location /ville {
       proxy_pass http://elliance-backend:8083/ville;
    }
    location /pays {
       proxy_pass http://elliance-backend:8083/pays;
    }
    location /codepostal {
       proxy_pass http://elliance-backend:8083/codepostal;
    }
    location /swagger-ui {
       
       proxy_pass http://elliance-backend:8083/swagger-ui;
    }
    location /emailaddress {
       
       proxy_pass http://elliance-backend:8083/emailaddress;
    }
     location /fichier {
       proxy_pass http://elliance-backend:8083/fichier;
    }

     location /typepersonnephysique {
       proxy_pass http://elliance-backend:8083/typepersonnephysique;
    }
     location /typepersonnemorale {
       proxy_pass http://elliance-backend:8083/typepersonnemorale;
    }
     location /w2p {
       proxy_pass http://elliance-backend:8083/w2p;
    }
     location /w2p-modele {
       proxy_pass http://elliance-backend:8083/w2p-modele;
    }
     location /parametre {
       proxy_pass http://elliance-backend:8083/parametre;
    }
     location /variablelogistique {
       proxy_pass http://elliance-backend:8083/variablelogistique;
    }
     location /pictocatalogue {
       proxy_pass http://elliance-backend:8083/pictocatalogue;
    }
	 location /picto {
       proxy_pass http://elliance-backend:8083/picto;
    }
	location /categorie {
       proxy_pass http://elliance-backend:8083/categorie;
    }
	location /pdf {
       proxy_pass http://elliance-backend:8083/pdf;
    }
	location /auditLog {
       proxy_pass http://elliance-backend:8083/auditLog;
    }
		location /dynamic-documents {
        proxy_pass http://elliance-backend:8083/dynamic-documents;
    }

    location /dynamic-document-infos {
		proxy_pass http://elliance-backend:8083/dynamic-document-infos;
    }

    location /dynamic-view-infos {
	proxy_pass http://elliance-backend:8083/dynamic-view-infos;
    }
    #location /auth/realms/bebeimage {
       
     #  proxy_pass http://keycloack:8080/auth/realms/bebeimage;
   # }


    location /view {

	proxy_pass http://elliance-backend:8083/view;
        proxy_set_header Host      $host:$server_port;
	proxy_set_header X-Real-IP $remote_addr;
     }
     location /template {

        proxy_pass http://elliance-backend:8083/template;
        proxy_set_header Host      $host:$server_port;
        proxy_set_header X-Real-IP $remote_addr;
     }

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

}
