server {
    listen       80;
    listen  [::]:80;
    server_name  soparco-elliance.geolane.fr;
    client_max_body_size 100M;
    location / {
      root   /usr/share/nginx/html;
      try_files $uri $uri/ /index.html;
      index  index.html index.htm;
      error_page 405 = $uri;
	  proxy_set_header Upgrade    $http_upgrade;
      proxy_set_header Connection $http_connection;
      proxy_set_header HOST $host;
      proxy_set_header X-Real-IP $remote_addr;

      add_header 'Access-Control-Allow-Origin' '*';
      add_header 'Access-Control-Allow-Credentials' 'true';
      proxy_set_header Host      $host:$server_port;
      proxy_set_header X-Real-IP $remote_addr;
  
 }
 
location /ws {
    # enable the next two lines for http auth
    #auth_basic "Restricted";
    #auth_basic_user_file /config/nginx/.htpasswd;

    proxy_pass http://elliance-backend:8080/ws;
    # enable the next two lines for ldap auth
    #auth_request /auth;
    #error_page 401 =200 /login;

    proxy_buffering off;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "Upgrade";
    proxy_ssl_verify off;
}

location /topic {
    # enable the next two lines for http auth
    #auth_basic "Restricted";
    #auth_basic_user_file /config/nginx/.htpasswd;

    proxy_pass http://172.19.0.10:8080/ws;
    # enable the next two lines for ldap auth
    #auth_request /auth;
    #error_page 401 =200 /login;

    proxy_buffering off;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "Upgrade";
    proxy_ssl_verify off;
}





    location /produit {

       proxy_pass http://elliance-gateway:8080/produit;
    }

    location /contrat {
     proxy_set_header Host      $host:$server_port;
     proxy_set_header X-Real-IP $remote_addr;
     proxy_pass http://elliance-gateway:8080/contrat;
    }

    location /user {

	proxy_pass http://elliance-backend:8080/user;
        proxy_set_header Host      $host:$server_port;
   	proxy_set_header X-Real-IP $remote_addr;
     }
     location /role {

        proxy_pass http://elliance-gateway:8080/role;
        proxy_set_header Host      $host:$server_port;
        proxy_set_header X-Real-IP $remote_addr;
     }

    location /personnemorale {
       
       proxy_pass http://elliance-gateway:8080/personnemorale;
    }
	location /droit {
		proxy_pass http://elliance-gateway:8080/droit;
        proxy_set_header Host      $host:$server_port;
		proxy_set_header X-Real-IP $remote_addr;
    }
	 
    location /personnephysique {
       
       proxy_pass http://elliance-backend:8080/personnephysique;
    }
    location /reportage-image {
       proxy_pass http://elliance-backend:8080/reportage-image;
    }
    location /photo {
       proxy_pass http://elliance-backend:8080/photo;
    }
    location /pp-image {
       proxy_pass http://elliance-backend:8080/reportage-image;
    }


    location /image {
       
       proxy_set_header Host      $host:$server_port;
       proxy_set_header X-Real-IP $remote_addr;
 
      proxy_pass http://elliance-backend:8080/image;
    }
    location /entite {
	
      proxy_set_header HOST $host;
      proxy_set_header X-Real-IP $remote_addr;

      add_header 'Access-Control-Allow-Origin' '*';
      add_header 'Access-Control-Allow-Credentials' 'true';
      #proxy_set_header Host      $host:$server_port;
      proxy_set_header X-Real-IP $remote_addr;
       


       proxy_pass http://elliance-backend:8080/entite;
    }

    location /email {
       
       proxy_pass http://elliance-backend:8080/email;
    }
    location /tel {
       
       proxy_pass http://elliance-backend:8080/tel;
    }
    location /fax {
       proxy_pass http://elliance-backend:8080/fax;
    }
    location /commentaire {
       proxy_pass http://elliance-backend:8080/commentaire;
    }
    location /ville {
       proxy_pass http://elliance-backend:8080/ville;
    }
    location /pays {
       proxy_pass http://elliance-backend:8080/pays;
    }
    location /codepostal {
       proxy_pass http://elliance-backend:8080/codepostal;
    }
    location /swagger-ui {
       
       proxy_pass http://elliance-backend:8080/swagger-ui;
    }
    location /emailaddress {
       
       proxy_pass http://elliance-backend:8080/emailaddress;
    }
     location /fichier {
       proxy_pass http://elliance-backend:8080/fichier;
    }

     location /typepersonnephysique {
       proxy_pass http://elliance-backend:8080/typepersonnephysique;
    }
	
	  location /catalog {
       proxy_pass http://elliance-backend:8080/catalog;
    }
     location /typepersonnemorale {
       proxy_pass http://elliance-backend:8080/typepersonnemorale;
    }
     location /w2p {
       proxy_pass http://elliance-backend:8080/w2p;
    }
     location /w2p-modele {
       proxy_pass http://elliance-backend:8080/w2p-modele;
    }
     location /parametre {
       proxy_pass http://elliance-backend:8080/parametre;
    }
     location /variablelogistique {
       proxy_pass http://elliance-backend:8080/variablelogistique;
    }
     location /pictocatalogue {
       proxy_pass http://elliance-backend:8080/pictocatalogue;
    }
	 location /picto {
       proxy_pass http://elliance-backend:8080/picto;
    }
	location /categorie {
       proxy_pass http://elliance-backend:8080/categorie;
    }
	location /pdf {
       proxy_pass http://elliance-backend:8080/pdf;
    }
	location /auditLog {
       proxy_pass http://elliance-backend:8080/auditLog;
    }
	location /task {
       proxy_pass  http://elliance-backend:8080/task;
    }
	
	location /adaptationplaque {
       proxy_pass  http://elliance-backend:8080/adaptationplaque;
    }
	
    #location /auth/realms/bebeimage {
       
     #  proxy_pass http://keycloack:8080/auth/realms/bebeimage;
   # }


    location /view {

	proxy_pass http://elliance-backend:8080/view;
        proxy_set_header Host      $host:$server_port;
   	proxy_set_header X-Real-IP $remote_addr;
     }
     location /template {

        proxy_pass http://elliance-backend:8080/template;
        proxy_set_header Host      $host:$server_port;
        proxy_set_header X-Real-IP $remote_addr;
     }
    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }

}

